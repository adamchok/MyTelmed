<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>MyTelmed - Referral Accepted</title>
        <style>
            body {
                font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: #333333;
                max-width: 800px;
                margin: 0 auto;
                padding: 20px;
                background-color: #f8f9fa;
            }

            .container {
                background-color: #ffffff;
                border-radius: 10px;
                padding: 30px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            }

            .header {
                text-align: center;
                justify-content: center;
                border-bottom: 3px solid #28a745;
                padding-bottom: 20px;
                margin-bottom: 30px;
            }

            .logo {
                width: 192px;
                height: auto;
                max-width: 100%;
                display: block;
                margin: 0 auto;
            }

            .acceptance-status {
                background-color: #d4edda;
                border: 1px solid #28a745;
                border-radius: 8px;
                padding: 20px;
                margin: 20px 0;
                text-align: center;
            }

            .acceptance-status .status-icon {
                font-size: 48px;
                color: #28a745;
                margin-bottom: 10px;
            }

            .acceptance-status h3 {
                color: #155724;
                margin: 0 0 10px 0;
            }

            .referral-details {
                background-color: #e8f5e8;
                border-left: 4px solid #28a745;
                padding: 20px;
                margin: 20px 0;
                border-radius: 5px;
            }

            .referral-number {
                font-size: 18px;
                font-weight: bold;
                color: #28a745;
                margin-bottom: 10px;
            }

            .accepted-badge {
                background-color: #28a745;
                color: white;
                padding: 8px 16px;
                border-radius: 20px;
                font-size: 14px;
                font-weight: bold;
                display: inline-block;
                margin-bottom: 15px;
            }

            .doctor-info {
                background-color: #f8f9fa;
                border: 1px solid #dee2e6;
                border-radius: 8px;
                padding: 20px;
                margin: 20px 0;
            }

            .info-row {
                display: flex;
                justify-content: space-between;
                align-items: flex-start;
                margin-bottom: 10px;
                padding: 8px 0;
                border-bottom: 1px solid #e9ecef;
            }

            .info-label {
                font-weight: bold;
                color: #495057;
                flex: 0 0 40%;
            }

            .info-value {
                color: #212529;
                text-align: right;
                flex: 1;
                word-break: break-word;
            }

            .next-steps {
                background-color: #cce7ff;
                border: 1px solid #007bff;
                border-radius: 8px;
                padding: 20px;
                margin: 20px 0;
            }

            .action-buttons {
                text-align: center;
                margin: 30px 0;
            }

            .btn {
                display: inline-block;
                padding: 12px 24px;
                margin: 10px;
                border-radius: 5px;
                text-decoration: none;
                font-weight: bold;
                transition: background-color 0.3s;
                border: 2px solid transparent;
            }

            .btn-primary {
                background-color: #007bff;
                color: white;
                border-color: #007bff;
            }

            .btn-primary:hover {
                background-color: #0056b3;
                border-color: #0056b3;
            }

            .btn-success {
                background-color: #28a745;
                color: white;
                border-color: #28a745;
            }

            .btn-success:hover {
                background-color: #218838;
                border-color: #218838;
            }

            .btn {
                background-color: #6c757d;
                color: white;
                border-color: #6c757d;
            }

            .btn:hover {
                background-color: #545b62;
                border-color: #545b62;
            }

            .important-notice {
                background-color: #fff3cd;
                border: 1px solid #ffeaa7;
                border-radius: 8px;
                padding: 20px;
                margin: 20px 0;
            }

            .footer {
                text-align: center;
                margin-top: 40px;
                padding-top: 20px;
                border-top: 1px solid #dee2e6;
                font-size: 12px;
                color: #6c757d;
            }

            .footer a {
                color: #007bff;
                text-decoration: none;
            }

            .footer a:hover {
                text-decoration: underline;
            }

            @media (max-width: 600px) {
                .info-row {
                    flex-direction: column;
                    align-items: flex-start;
                }

                .info-value {
                    text-align: left;
                    margin-top: 5px;
                }

                .btn {
                    display: block;
                    margin: 10px 0;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <h2 style="color: #495057; margin: 10px 0 0 0">Referral Accepted</h2>
            </div>

            <div class="acceptance-status">
                <div class="status-icon">âœ…</div>
                <h3>Great News! Your Referral Has Been Accepted</h3>
                <p style="margin: 0; color: #155724">
                    The specialist has reviewed and accepted your medical referral. You can now proceed with scheduling your
                    appointment.
                </p>
            </div>

            <div class="referral-details">
                <div class="referral-number">Referral #<span th:text="${referralNumber}">REF-001</span></div>

                <div class="accepted-badge">
                    âœ… Accepted on <span th:text="${#temporals.format(acceptedAt, 'dd MMM yyyy')}">Date</span>
                </div>

                <h4 style="margin: 15px 0 10px 0; color: #28a745">Referral Information</h4>

                <div class="info-row">
                    <span class="info-label">Patient Name:</span>
                    <span class="info-value" th:text="${patientName}">Patient Name</span>
                </div>

                <div class="info-row">
                    <span class="info-label">Referral Type:</span>
                    <span
                        class="info-value"
                        th:text="${referralType == 'INTERNAL' ? 'Internal Specialist' : 'External Specialist'}"
                        >Type</span
                    >
                </div>

                <div class="info-row">
                    <span class="info-label">Accepted Date:</span>
                    <span class="info-value" th:text="${#temporals.format(acceptedAt, 'EEEE, dd MMMM yyyy HH:mm')}"
                        >Date</span
                    >
                </div>

                <div class="info-row">
                    <span class="info-label">Reason for Referral:</span>
                    <span class="info-value" th:text="${reasonForReferral}">Reason</span>
                </div>
            </div>

            <div class="doctor-info">
                <h4 style="margin: 0 0 15px 0; color: #495057">Referring Doctor</h4>

                <div class="info-row">
                    <span class="info-label">Doctor Name:</span>
                    <span class="info-value" th:text="${referringDoctorName}">Dr. Name</span>
                </div>
            </div>

            <!-- Internal Referral Details -->
            <div th:if="${referralType == 'INTERNAL'}" class="doctor-info">
                <h4 style="margin: 0 0 15px 0; color: #28a745">Accepting Specialist (MyTelmed Network)</h4>

                <div class="info-row">
                    <span class="info-label">Specialist Name:</span>
                    <span class="info-value" th:text="${referredDoctorName}">Dr. Specialist</span>
                </div>

                <div class="info-row" th:if="${referredDoctorSpeciality}">
                    <span class="info-label">Speciality:</span>
                    <span class="info-value" th:text="${referredDoctorSpeciality}">Speciality</span>
                </div>

                <div class="info-row" th:if="${facilityName}">
                    <span class="info-label">Healthcare Facility:</span>
                    <span class="info-value" th:text="${facilityName}">Facility Name</span>
                </div>
            </div>

            <!-- Next Steps for Internal Referrals -->
            <div th:if="${referralType == 'INTERNAL'}" class="next-steps">
                <h4 style="margin: 0 0 15px 0; color: #0066cc">ðŸ“‹ Next Steps</h4>
                <ol style="margin: 0; color: #0066cc; padding-left: 20px">
                    <li>
                        <strong>Schedule Your Appointment:</strong> You can now book an appointment with the specialist
                        through the MyTelmed platform
                    </li>
                    <li>
                        <strong>Prepare for Consultation:</strong> Gather any relevant medical records, test results, or
                        current medications
                    </li>
                    <li>
                        <strong>Specialist Review:</strong> The specialist will review your referral details and clinical
                        summary before the appointment
                    </li>
                    <li><strong>Receive Specialized Care:</strong> Get the expert medical attention you need</li>
                </ol>
            </div>

            <!-- Next Steps for External Referrals -->
            <div th:if="${referralType == 'EXTERNAL'}" class="next-steps">
                <h4 style="margin: 0 0 15px 0; color: #0066cc">ðŸ“‹ Next Steps</h4>
                <ol style="margin: 0; color: #0066cc; padding-left: 20px">
                    <li>
                        <strong>Contact External Facility:</strong> Please contact the external healthcare facility directly
                        to schedule your appointment
                    </li>
                    <li><strong>Bring Referral Information:</strong> Provide them with your referral number and details</li>
                    <li><strong>Prepare Documentation:</strong> Gather relevant medical records and current medications</li>
                    <li><strong>Follow Up:</strong> Keep your referring doctor informed about the external consultation</li>
                </ol>
            </div>

            <div class="action-buttons">
                <a th:href="${uiHost + '/patient/referrals'}" class="btn btn-primary"> View All Referrals </a>
                <a
                    th:if="${referralType == 'INTERNAL'}"
                    th:href="${uiHost + '/patient/appointment/book'}"
                    class="btn btn-success"
                >
                    Schedule Appointment
                </a>
                <a th:href="${uiHost + '/patient/support'}" class="btn"> Contact Support </a>
            </div>

            <!-- Important Information -->
            <div class="important-notice">
                <h4 style="margin: 0 0 10px 0; color: #856404">ðŸ“Œ Important Information</h4>
                <ul style="margin: 0; color: #856404">
                    <li th:if="${referralType == 'INTERNAL'}">
                        Book your appointment as soon as possible to ensure timely specialist care
                    </li>
                    <li th:if="${referralType == 'EXTERNAL'}">
                        Contact the external facility directly using the contact information provided in your original
                        referral
                    </li>
                    <li>
                        Bring this referral information and any relevant medical documents to your specialist appointment
                    </li>
                    <li>If you have questions about your referral, contact your referring doctor or our support team</li>
                    <li>Keep track of your referral status through your MyTelmed patient portal</li>
                </ul>
            </div>

            <!-- Clinical Information (if available) -->
            <div
                th:if="${clinicalSummary != null or currentMedications != null or allergies != null or investigationsDone != null}"
                class="doctor-info"
            >
                <h4 style="margin: 0 0 15px 0; color: #495057">Clinical Information for Specialist</h4>

                <div th:if="${clinicalSummary}">
                    <strong>Clinical Summary:</strong>
                    <p th:text="${clinicalSummary}" style="margin: 5px 0 15px 0; white-space: pre-line">Clinical Summary</p>
                </div>

                <div th:if="${currentMedications}">
                    <strong>Current Medications:</strong>
                    <p th:text="${currentMedications}" style="margin: 5px 0 15px 0; white-space: pre-line">Medications</p>
                </div>

                <div th:if="${allergies}">
                    <strong>Known Allergies:</strong>
                    <p th:text="${allergies}" style="margin: 5px 0 15px 0; white-space: pre-line">Allergies</p>
                </div>

                <div th:if="${investigationsDone}">
                    <strong>Investigations Done:</strong>
                    <p th:text="${investigationsDone}" style="margin: 5px 0 0 0; white-space: pre-line">Investigations</p>
                </div>
            </div>

            <p>
                <strong>Congratulations!</strong> Your referral has been accepted and you're one step closer to receiving
                specialized medical care. The specialist has reviewed your case and is ready to provide you with expert
                medical attention.
            </p>

            <p>
                This acceptance is part of your comprehensive care plan under the Malaysian public healthcare telemedicine
                program, ensuring you receive timely access to specialized medical services.
            </p>

            <p>
                Best regards,<br />
                MyTelmed Medical Team<br />
                Malaysian Public Healthcare Telemedicine Services
            </p>

            <div class="footer">
                <p>
                    This referral acceptance notification is generated electronically and is part of your official medical
                    record.
                </p>
                <p>&copy; 2025 MyTelmed. All rights reserved.</p>
                <p>
                    <a th:href="${uiHost + '/privacy'}">Privacy Policy</a> |
                    <a th:href="${uiHost + '/terms'}">Terms of Service</a>
                </p>
            </div>
        </div>
    </body>
</html>
