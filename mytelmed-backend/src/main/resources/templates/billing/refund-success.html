<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>MyTelmed - Refund Processed Successfully</title>
        <style>
            /* Base Styles */
            body {
                font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: #333333;
                max-width: 600px;
                margin: 0 auto;
                padding: 10px;
                background-color: #f8f9fa;
                -webkit-text-size-adjust: 100%;
                -ms-text-size-adjust: 100%;
                box-sizing: border-box;
            }

            .container {
                background-color: #ffffff;
                border-radius: 10px;
                padding: 25px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
                width: 100%;
                box-sizing: border-box;
            }

            .header {
                text-align: center;
                justify-content: center;
                border-bottom: 3px solid #17a2b8;
                padding-bottom: 15px;
                margin-bottom: 25px;
            }

            .header h2 {
                color: #495057;
                margin: 10px 0 0 0;
                font-size: 26px;
                font-weight: 600;
            }

            .logo {
                width: 192px;
                height: auto;
                max-width: 100%;
                display: block;
                margin: 0 auto;
            }

            .refund-status {
                background-color: #d1ecf1;
                border: 1px solid #bee5eb;
                border-radius: 8px;
                padding: 20px;
                margin: 20px 0;
                text-align: center;
            }

            .refund-status .status-icon {
                font-size: 48px;
                color: #17a2b8;
                margin-bottom: 10px;
                display: block;
            }

            .refund-status h3 {
                color: #0c5460;
                margin: 0 0 10px 0;
                font-size: 20px;
            }

            .refund-status p {
                margin: 0;
                color: #0c5460;
                font-size: 16px;
            }

            .refund-amount {
                font-size: 28px;
                font-weight: bold;
                color: #17a2b8;
                margin: 10px 0;
            }

            .refund-details {
                background-color: #f8f9fa;
                border: 1px solid #dee2e6;
                border-radius: 8px;
                padding: 20px;
                margin: 20px 0;
            }

            .refund-details h4 {
                color: #495057;
                margin: 0 0 15px 0;
                font-size: 18px;
                border-bottom: 2px solid #17a2b8;
                padding-bottom: 8px;
            }

            .detail-row {
                display: flex;
                justify-content: space-between;
                padding: 8px 0;
                border-bottom: 1px solid #e9ecef;
            }

            .detail-row:last-child {
                border-bottom: none;
                font-weight: bold;
                background-color: #e9ecef;
                margin: 10px -20px -20px -20px;
                padding: 15px 20px;
                border-radius: 0 0 8px 8px;
            }

            .detail-label {
                font-weight: 600;
                color: #6c757d;
                flex: 1;
            }

            .detail-value {
                color: #495057;
                text-align: right;
                flex: 1;
            }

            .stripe-receipt {
                background-color: #fff3cd;
                border: 1px solid #ffeaa7;
                border-radius: 8px;
                padding: 20px;
                margin: 20px 0;
            }

            .stripe-receipt h4 {
                color: #856404;
                margin: 0 0 15px 0;
                font-size: 16px;
                display: flex;
                align-items: center;
            }

            .stripe-receipt .stripe-logo {
                margin-left: 10px;
                font-weight: bold;
                color: #6772e5;
            }

            .receipt-info {
                font-size: 14px;
                color: #856404;
                line-height: 1.5;
            }

            .receipt-info strong {
                color: #495057;
            }

            .original-payment {
                background-color: #e9ecef;
                border-radius: 8px;
                padding: 15px;
                margin: 15px 0;
            }

            .original-payment h5 {
                margin: 0 0 10px 0;
                color: #495057;
                font-size: 16px;
            }

            .timeline {
                margin: 20px 0;
                padding-left: 20px;
                border-left: 3px solid #17a2b8;
            }

            .timeline-item {
                margin-bottom: 15px;
                padding-left: 20px;
                position: relative;
            }

            .timeline-item::before {
                content: "•";
                position: absolute;
                left: -8px;
                color: #17a2b8;
                font-size: 20px;
                font-weight: bold;
            }

            .timeline-item h6 {
                margin: 0 0 5px 0;
                color: #495057;
                font-size: 14px;
                font-weight: bold;
            }

            .timeline-item p {
                margin: 0;
                color: #6c757d;
                font-size: 13px;
            }

            .cta-buttons {
                text-align: center;
                margin: 30px 0;
                padding: 20px;
                background-color: #f8f9fa;
                border-radius: 8px;
            }

            .btn {
                display: inline-block;
                padding: 12px 24px;
                margin: 0 10px;
                background-color: #007bff;
                color: #ffffff;
                text-decoration: none;
                border-radius: 5px;
                font-weight: bold;
                transition: background-color 0.3s ease;
            }

            .btn:hover {
                background-color: #0056b3;
            }

            .btn-info {
                background-color: #17a2b8;
            }

            .btn-info:hover {
                background-color: #138496;
            }

            .content-text {
                font-size: 16px;
                line-height: 1.6;
                margin-bottom: 16px;
            }

            .footer {
                border-top: 1px solid #dee2e6;
                padding-top: 20px;
                margin-top: 30px;
                text-align: center;
                color: #6c757d;
                font-size: 14px;
            }

            .footer p {
                margin: 8px 0;
            }

            .footer a {
                color: #007bff;
                text-decoration: none;
            }

            .footer a:hover {
                text-decoration: underline;
            }

            .important-notice {
                background-color: #fff3cd;
                border: 1px solid #ffeaa7;
                border-radius: 8px;
                padding: 15px;
                margin: 20px 0;
            }

            .important-notice h5 {
                color: #856404;
                margin: 0 0 10px 0;
                font-size: 16px;
            }

            .important-notice p {
                margin: 0;
                color: #856404;
                font-size: 14px;
            }

            /* Mobile Responsive */
            @media screen and (max-width: 600px) {
                body {
                    padding: 5px;
                }

                .container {
                    padding: 15px;
                    border-radius: 5px;
                }

                .header h2 {
                    font-size: 22px;
                }

                .refund-status .status-icon {
                    font-size: 40px;
                }

                .refund-amount {
                    font-size: 24px;
                }

                .detail-row {
                    flex-direction: column;
                    gap: 5px;
                }

                .detail-value {
                    text-align: left;
                }

                .btn {
                    display: block;
                    margin: 10px 0;
                    width: 100%;
                    box-sizing: border-box;
                }

                .timeline {
                    padding-left: 15px;
                }

                .timeline-item {
                    padding-left: 15px;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <!-- Header -->
            <div class="header">
                <img
                    src="https://mytelmed.s3.amazonaws.com/assets/logo/mytelmed-logo.png"
                    alt="MyTelmed Logo"
                    class="logo"
                />
                <h2>Refund Processed Successfully</h2>
            </div>

            <!-- Refund Status -->
            <div class="refund-status">
                <span class="status-icon">💰</span>
                <h3>Your Refund Has Been Processed</h3>
                <div class="refund-amount">RM <span th:text="${refundAmount}">50.00</span></div>
                <p>The refund has been successfully processed and will appear in your account within 3-5 business days.</p>
            </div>

            <!-- Greeting -->
            <div class="content-text">Dear <strong th:text="${patientName}">Patient</strong>,</div>

            <div class="content-text">
                We're writing to confirm that your refund has been successfully processed. Below are the details of your
                refund transaction.
            </div>

            <!-- Refund Details -->
            <div class="refund-details">
                <h4>Refund Details</h4>
                <div class="detail-row">
                    <div class="detail-label">Refund Amount:</div>
                    <div class="detail-value">RM <span th:text="${refundAmount}">50.00</span></div>
                </div>
                <div class="detail-row">
                    <div class="detail-label">Bill Number:</div>
                    <div class="detail-value" th:text="${billNumber}">BIL-12345</div>
                </div>
                <div class="detail-row">
                    <div class="detail-label">Transaction Number:</div>
                    <div class="detail-value" th:text="${transactionNumber}">TXN-67890</div>
                </div>
                <div class="detail-row">
                    <div class="detail-label">Service Type:</div>
                    <div class="detail-value">
                        <span th:if="${billType == 'CONSULTATION'}">Virtual Consultation</span>
                        <span th:if="${billType == 'MEDICATION'}">Medication Delivery</span>
                        <span th:if="${billType != 'CONSULTATION' && billType != 'MEDICATION'}" th:text="${billType}"
                            >Service</span
                        >
                    </div>
                </div>
                <div class="detail-row">
                    <div class="detail-label">Refund Reason:</div>
                    <div class="detail-value" th:text="${refundReason}">Service cancellation</div>
                </div>
                <div class="detail-row">
                    <div class="detail-label">Processed Date:</div>
                    <div class="detail-value" th:text="${#temporals.format(refundProcessedAt, 'dd MMMM yyyy, h:mm a')}">
                        12 Dec 2024, 3:45 PM
                    </div>
                </div>
            </div>

            <!-- Stripe Receipt Information -->
            <div class="stripe-receipt">
                <h4>Payment Processing Details <span class="stripe-logo">Stripe</span></h4>
                <div class="receipt-info">
                    <p><strong>Stripe Refund ID:</strong> <span th:text="${stripeRefundId}">re_1234567890</span></p>
                    <p><strong>Original Charge ID:</strong> <span th:text="${originalChargeId}">ch_1234567890</span></p>
                    <p>
                        This refund has been processed through Stripe, our secure payment processor. You can reference the
                        Refund ID above for any payment-related inquiries.
                    </p>
                </div>
            </div>

            <!-- Original Payment Information -->
            <div class="original-payment">
                <h5>Original Payment Information</h5>
                <div style="display: flex; justify-content: space-between; margin-bottom: 8px">
                    <span>Original Amount Paid:</span>
                    <span>RM <span th:text="${originalAmount}">50.00</span></span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 8px">
                    <span>Payment Date:</span>
                    <span th:text="${#temporals.format(originalPaymentDate, 'dd MMMM yyyy')}">10 Dec 2024</span>
                </div>
                <div style="display: flex; justify-content: space-between; font-weight: bold; color: #17a2b8">
                    <span>Refunded Amount:</span>
                    <span>RM <span th:text="${refundAmount}">50.00</span></span>
                </div>
            </div>

            <!-- Timeline -->
            <div class="timeline">
                <div class="timeline-item">
                    <h6>Payment Received</h6>
                    <p th:text="${#temporals.format(originalPaymentDate, 'dd MMMM yyyy')}">
                        Original payment was successfully processed
                    </p>
                </div>
                <div class="timeline-item">
                    <h6>Refund Requested</h6>
                    <p>Refund was initiated based on: <span th:text="${refundReason}">cancellation policy</span></p>
                </div>
                <div class="timeline-item">
                    <h6>Refund Processed</h6>
                    <p th:text="${#temporals.format(refundProcessedAt, 'dd MMMM yyyy, h:mm a')}">
                        Refund has been successfully processed by Stripe
                    </p>
                </div>
                <div class="timeline-item">
                    <h6>Funds Available</h6>
                    <p>Refund will appear in your account within 3-5 business days</p>
                </div>
            </div>

            <!-- Important Notice -->
            <div class="important-notice">
                <h5>⚠️ Important Information</h5>
                <p>
                    <strong>Processing Time:</strong> Refunds typically take 3-5 business days to appear in your account,
                    depending on your bank or payment method.
                </p>
                <p>
                    <strong>Questions?</strong> If you have any questions about this refund, please contact our support team
                    with your Bill Number or Stripe Refund ID.
                </p>
            </div>

            <!-- Call to Action -->
            <div class="cta-buttons">
                <a th:href="${uiHost + '/patient/billing'}" class="btn btn-info">View Billing History</a>
                <a th:href="${uiHost + '/patient/dashboard'}" class="btn">Return to Dashboard</a>
            </div>

            <div class="content-text">
                We apologize for any inconvenience that led to this refund. We're committed to providing you with the best
                healthcare experience and look forward to serving you again in the future.
            </div>

            <div class="content-text">
                <strong>Thank you for choosing MyTelmed for your healthcare needs.</strong>
            </div>

            <!-- Footer -->
            <div class="footer">
                <p><strong>MyTelmed</strong> - Malaysian Public Healthcare Telemedicine</p>
                <p>
                    Questions? Contact us at
                    <a href="mailto:support@mytelmed.com">support@mytelmed.com</a> or
                    <a href="tel:+60123456789">+60 12-345 6789</a>
                </p>
                <p>
                    <a th:href="${uiHost}">Visit MyTelmed</a> | <a th:href="${uiHost + '/terms'}">Terms of Service</a> |
                    <a th:href="${uiHost + '/privacy'}">Privacy Policy</a>
                </p>
                <p style="margin-top: 15px; font-size: 12px; color: #999">
                    This email was sent to confirm your refund processing. Please keep this email for your records. If you
                    believe you received this email in error, please contact our support team immediately.
                </p>
            </div>
        </div>
    </body>
</html>
